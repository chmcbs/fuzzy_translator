# Fuzzy Translator

A simple multi-language translation API using the [Facebook NLLB](https://huggingface.co/facebook/nllb-200-distilled-600M) transformer from HuggingFace.

**Supported languages:**

- ğŸ‡¬ğŸ‡§ English 
- ğŸ‡°ğŸ‡· Korean
- ğŸ‡¨ğŸ‡³ Chinese (Simplified)
- ğŸ‡¹ğŸ‡¼ Chinese (Traditional)
- ğŸ‡ªğŸ‡¸ Spanish
- ğŸ‡¬ğŸ‡· Greek

## Installation

**Prerequisites:** Python 3.11+

**NOTE:** the model will need to be downloaded on the first run. This usually takes a few minutes.

#### With Docker (recommended)

1. `docker build -t fuzzy_translator .`
2. `docker run -p 8000:8000 fuzzy_translator`

#### Without Docker

1. Create a fresh virtual environment (recommended)
2. `pip install -r requirements.txt`
3. `uvicorn app:app --reload`

## Project Structure

- `app.py`          - FastAPI application and translation endpoint
- `tests.py`        - unit tests
- `requirements.txt` - dependencies
- `Dockerfile`      - container setup
- `notebook.ipynb`  - initial model test

## API Reference

Interactive API docs (Swagger UI) can be found at **http://127.0.0.1:8000/docs**

#### `GET /health`

Returns the health of the server.

#### `GET /languages`

Lists the languages available for translation.

#### `GET /metrics`

Returns Prometheus-formatted metrics.

#### `POST /translate`

Translates text from source to target language.

**Request body:**
| Field    | Type   | Description                    |
|----------|--------|--------------------------------|
| `text`   | string | Text to translate (1-100 characters)|
| `source` | string | Source language                 |
| `target` | string | Target language                |

**Example usage:**

ğŸ—£ï¸ `curl -X POST "http://127.0.0.1:8000/translate" -H "Content-Type: application/json" -d '{"text": "Hello!", "source": "english", "target": "korean"}'`

â†©ï¸ `"ì•ˆë…•í•˜ì„¸ìš”!"`

| Status Code | Description                                       |
|-------------|---------------------------------------------------|
| 200         | Translation successful                            |
| 422         | Validation error (input empty/exceeds 100 chars, unsupported language) |
| 503         | Model not loaded                                  |
| 500         | Unexpected server error                           |

## Testing

**Docker:** `docker run fuzzy_translator pytest tests.py`

**Locally:** `pytest tests.py`

## Design Decisions

**Translation model:** `facebook/nllb-200-distilled-600M` is the most downloaded translation model on HuggingFace with multi-language support that includes Korean.

**FastAPI:** chosen due to its simplicity, autogenerated documentation, Pydantic request validation, and integrated JSON error handling.

**Lifespan:** the model is preloaded at startup with FastAPI's lifespan hook. Loading takes around 1 minute, which would be incredibly inefficient to do on every call.

## Production Considerations

**Concurrency:** in its current state, FastAPI runs on uvicorn with a single worker. To handle multiple requests simultaneously, multiple container replicas can be run behind a load balancer, each holding its own copy of the model in memory.

**Monitoring:** the `/metrics` endpoint currently exposes request latency, error rates, and system resource usage. These metrics could be scraped on an interval and fed into a dashboard to track change over time.

**Scaling:** as each container replica needs its own copy of the model, memory is a key constraint when scaling. To handle this, model weights could be cached in a shared location to eliminate the need to re-download for each container.

**Input validation:** currently regulated by Pydantic validation, but not screened for profanity. Both input and output could be monitored for inappropriate content with a simple classifier.